<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <style>
        .message-ball {
            font-size: 20px;
            line-height: 200px;
            text-align: center;
        }

        .circle {
            transition-property: width, height, margin-left, margin-top;
            transition-duration: 2s;
            position: fixed;
            transform: translateX(-50%) translateY(-50%);
            background-color: red;
            border-radius: 50%;
        }
    </style>
</head>

<body>

    <button>showCircle(150, 150, 100)</button>
    <p title="About W3Schools">W3Schools is a web developer's site.</p>

    <script>
        // const btn = document.querySelector('button');

        // btn.addEventListener('click', () => {
        //     showCircle(150, 150, 100, div => {
        //         div.classList.add('message-ball');
        //         div.append("Hello, world!");
        //     });
        // })


        // function showCircle(cx, cy, radius, callback) {
        //     let div = document.createElement('div');
        //     div.style.width = 0;
        //     div.style.height = 0;
        //     div.style.left = cx + 'px';
        //     div.style.top = cy + 'px';
        //     div.className = 'circle';
        //     document.body.append(div);

        //     setTimeout(() => {
        //         div.style.width = radius * 2 + 'px';
        //         div.style.height = radius * 2 + 'px';

        //         div.addEventListener('transitionend', function handler() {
        //             div.removeEventListener('transitionend', handler)
        //             callback(div)
        //         })
        //     }, 1000)
        // }

        // const btn = document.querySelector('button');

        // btn.addEventListener('click', () => {
        //     const promise = showCircle(150, 150, 100)
        //         .then(div => {
        //             div.classList.add('message-ball');
        //             div.append("Hello, world!");
        //         })
        // })

        // function showCircle(cx, cy, radius) {
        //     return new Promise((resolve, reject) => {
        //         let div = document.createElement('div');
        //         div.style.width = 0;
        //         div.style.height = 0;
        //         div.style.left = cx + 'px';
        //         div.style.top = cy + 'px';
        //         div.className = 'circle';
        //         document.body.append(div);

        //         setTimeout(() => {
        //             div.style.width = radius * 2 + 'px';
        //             div.style.height = radius * 2 + 'px';

        //             div.addEventListener('transitionend', function handler() {
        //                 div.removeEventListener('transitionend', handler)
        //                 resolve(div);
        //             })
        //         })
        //     })
        // }




        // const promise = new Promise(function (resolve, reject) {
        //     setTimeout(() => {
        //         // resolve('done')
        //         reject(new Error('Whoops!'))

        //     }, 1000)
        // })

        // promise.then(
        //     result => alert(result),
        //     // error => alert(error)
        // )
        // promise.catch(alert);

        // const promise = new Promise((resolve, reject) => {
        //     throw new Error("error");
        // })
        //     .finally(() => alert('Promise finished'))
        //     .catch(error => alert(error)) // <-- .catch обработает объект ошибки

        // const promise = new Promise((resolve, reject) => {
        //     reject(new Error('error'))
        // })
        //     .finally(() => alert('Promise finished'))
        //     .catch(error => alert(error)) // <-- .catch обработает объект ошибки

        // // при создании промиса он сразу переводится в состояние "успешно завершён"
        // let promise = new Promise(resolve => resolve("готово!"));

        // promise.then(alert); // готово! (выведется сразу)


        // function loadScript(src) {
        //     return new Promise(function (resolve, reject) {
        //         alert(src);
        //         let script = document.createElement('script');
        //         script.src = src;

        //         script.onload = () => resolve(script);
        //         script.onerror = () => reject(new Error(`Ошибка загрузки скрипта ${src}`));

        //         document.head.append(script);
        //     });
        // }

        // let promise = loadScript("https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.js");

        // promise.then(
        //     script => alert(`${script.src} загружен!`),
        //     error => alert(`Ошибка: ${error.message}`)
        // );

        // promise.then(script => alert('Ещё один обработчик...'));


        function delay(ms) {
            // return new Promise((resolve, reject) => {
            //     setTimeout(() => resolve(), ms)
            // })
            return new Promise((resolve, reject) => {
                if (ms < 0) {
                    return reject(new Error("Time is not valid"));
                }
                return setTimeout(() => resolve(ms), ms)
            })
            // return new Promise(resolve => setTimeout(resolve, ms))
        }

        delay(3000)
            .then((ms) => alert(`выполнилось через ${ms} секунды`))
            .catch(alert)


    </script>

</body>

</html>